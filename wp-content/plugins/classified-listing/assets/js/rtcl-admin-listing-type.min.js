!function(e){e(document).on("click",".listing-type .action span.edit",function(){e(this).parents("li").find(".edit-action").slideToggle()}),e("#input-new-type-form").on("submit",function(a){a.preventDefault();var t=e(this),l=e(t),s=e("#rtcl-add-btn",l),i=e("#add-input-type",l),n=i.val();if(l.find(".alert").remove(),n){var d={action:"rtcl_ajax_add_listing_type",type:n};d[rtcl.nonceId]=rtcl.nonce,e.ajax({url:rtcl.ajaxurl,data:d,type:"POST",beforeSend:function(){s.addClass("spinner rtcl-loading").prop("disabled",!0)},success:function(a){a.success&&(i.val(""),function(a){var t=function(e){return'<li class="list-group-item listing-type" data-id="'+e.id+'"><div class="type-details d-flex"><div class="type-info"><div class="type-info-id">'+e.id+'</div><div class="type-info-name">'+e.name+'</div></div><div class="action ml-auto"><span class="btn btn-success btn-sm edit">Edit</span><span class="btn btn-danger btn-sm  delete">Delete</span></div></div><div class="edit-action"><form class="row input-update-type-form"><div class="form-group col-6"><label>ID</label><input type="text" name="id" class="form-control" value="'+e.id+'" ></div><div class="form-group col-6"><label>Type</label><input type="text" name="name" class="form-control" value="'+e.name+'" ></div><div class="form-group col-12"><button class="btn btn-primary btn-sm w-100">Update</button></div></form></div></div></li>'}(a),l=e("#rtcl-listing-type-wrap"),s=e(l,"#listing-types");s.length||(s=e("<ul id='listing-types' class='list-group' />"),l.html(s));s.append(t)}(a.data));var t=a.success?"alert-success":"alert-danger",n=e('<div class="col-12 alert alert-dismissible fade show" role="alert" />').append(a.message);n.addClass(t),l.append(n),s.removeClass("spinner rtcl-loading").prop("disabled",!1)},error:function(a){e('<div class="col-12 alert alert-danger alert-dismissible fade show" role="alert" />').append("Server Error !!!").appendTo(l),s.removeClass("spinner rtcl-loading").prop("disabled",!1)}})}else e('<div class="alert alert-danger alert-dismissible fade show" role="alert" />').append("Please fill type.").appendTo(l),i.focus()}),e(document).on("submit",".input-update-type-form",function(a){a.preventDefault();var t=e(this),l=t.closest("li"),s=l.data("id")||"",i=e(".type-info-id",l),n=e(".type-info-name",l),d=t.find("button[type=submit]"),r=t.find("input[name=id]"),o=r.val()||"",c=t.find("input[name=name]"),p=c.val()||"";if(t.find(".alert").remove(),o&&p&&s){var u={action:"rtcl_ajax_update_listing_type",name:p,id:o,old_id:s};u[rtcl.nonceId]=rtcl.nonce,e.ajax({url:rtcl.ajaxurl,data:u,type:"POST",beforeSend:function(){d.addClass("spinner rtcl-loading").prop("disabled",!0),t.find(".alert").remove()},success:function(a){r.val(a.data.id),c.val(a.data.name),a.success&&(i.text(a.data.id),n.text(a.data.name),l.data("id",a.data.id)),d.removeClass("spinner rtcl-loading").prop("disabled",!1);var s=a.success?"alert-success":"alert-danger",o=e('<div class="col-12 alert alert-dismissible fade show" role="alert" />').append(a.message);o.addClass(s),t.append(o)},error:function(a){console.log(a),e('<div class="col-12 alert alert-danger alert-dismissible fade show" role="alert" />').append("Server Error !!!").appendTo(t),d.removeClass("spinner rtcl-loading").prop("disabled",!1)}})}else e('<div class="col-12 alert alert-danger alert-dismissible fade show" role="alert" />').append("Please fill id and type.").appendTo(t)}),e(document).on("click",".listing-type .action span.delete:not(.disabled)",function(){if(confirm("Are you sure to delete this type?")){var a=e(this),t=a.parents("li.listing-type"),l=t.data("id");if(l){var s={action:"rtcl_ajax_delete_listing_type",id:l};s[rtcl.nonceId]=rtcl.nonce,e.ajax({url:rtcl.ajaxurl,data:s,type:"POST",beforeSend:function(){a.addClass("spinner rtcl-loading disabled").prop("disabled",!1)},success:function(l){l.success?t.slideUp("slow",function(){e(this).remove()}):(a.removeClass("spinner rtcl-loading disabled").prop("disabled",!1),alert(l.message))},error:function(e){a.removeClass("spinner rtcl-loading disabled").prop("disabled",!1),console.log(e)}})}else alert("Type id is required.")}})}(jQuery);
