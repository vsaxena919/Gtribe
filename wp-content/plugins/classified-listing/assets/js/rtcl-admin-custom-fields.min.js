!function(t){"use strict";t(function(){n(),o()});var e=t("body");function o(){jQuery(document).on("blur focus click",".js-rtcl-slugize",function(){var t=jQuery(this).val();if(""==t&&(t=jQuery(".js-rtcl-slugize-source",jQuery(this).closest(".postbox")).val()),""!=t){var e=function(t){if("string"!=typeof t||""==t)return;return t=(t=(t=(t=(t=t.toLowerCase()).replace(/[^a-z0-9A-Z_]+/g,"-")).replace(/\-+/g,"-")).replace(/^\-/g,"")).replace(/\-$/g,"")}(t);e==t&&""!=jQuery(this).val()||jQuery(this).val(e.substring(0,200))}})}function n(){t("#rtcl-cfg").sortable({cursor:"ns-resize",axis:"y",handle:"h3.hndle",forcePlaceholderSize:!0,tolerance:"pointer",start:function(t,e){e.placeholder.height(e.item.height()+23)}})}t(document).on("click","#rtcl-cf-add-new",function(e){e.preventDefault();var i=t(this),a=t('<div style="display:none;height:450px;" class="rtcl-choose-field"><span class="rtcl-loading dashicons dashicons-update animate-spin"></span>'+i.data("message-loading")+"</div>").appendTo("body");function l(e){var i;t("#post-body-content #rtcl-cfg").append(e),i=t("#post-body-content #rtcl-cfg .postbox").last(),t("html, body").animate({scrollTop:i.offset().top-50},1e3),a.dialog("close"),o(),t(".postbox .hndle, .postbox .handlediv").unbind("click.postboxes"),postboxes.add_postbox_toggles(),i.typesFieldOptionsSortable(),i.typesMarkExistingField(),n()}return a.dialog({close:function(t,e){a.remove()},closeText:!1,modal:!0,minWidth:810,maxHeight:.9*t(window).height(),title:i.data("dialog-title"),position:{my:"center top+50",at:"center top",of:window}}),a.load(ajaxurl,{action:"rtcl_edit_field_choose"},function(e,o,n){t(this).closest(".ui-dialog-content");t(a).on("click","span.rtcl-field-button-insert",function(){var e=t(this),o=e.data("type");console.log(o),t.ajax({url:ajaxurl,method:"POST",data:{action:"rtcl_edit_field_insert",type:o,id:parseInt(t("#post_ID").val(),10),__rtcl_wpnonce:rtcl_cfg.__rtcl_wpnonce},beforeSend:function(){e.append("<span class='rtcl-loading dashicons dashicons-update animate-spin'></span>")},success:function(o){t(".rtcl-loading",e).remove(),o.error?alert(o.msg):l(o.data)},error:function(o,n){t(".rtcl-loading",e).remove(),alert("Uncaught Error.\n"+o.responseText)}})})}),!1}),t(document).on("click",".js-rtcl-field-remove",function(){if(confirm(t(this).data("message-confirm"))){var e=t(this),o=e.closest(".postbox"),n=parseInt(o.data("id"),10);n?t.ajax({url:ajaxurl,method:"POST",data:{action:"rtcl_edit_field_delete",id:n,__rtcl_wpnonce:rtcl_cfg.__rtcl_wpnonce},beforeSend:function(){e.append("<span class='rtcl-loading dashicons dashicons-update animate-spin'></span>")},success:function(n){t(".rtcl-loading",e).remove(),n.error?alert(n.msg):o.slideUp(function(){t(this).remove()})},error:function(o,n){t(".rtcl-loading",e).remove(),alert("Uncaught Error.\n"+o.responseText)}}):alert("Field id not selected")}return!1}),t(document).on("click",".rtcl-cfg-field .rtcl-select-options-wrap .rtcl-add-new-option",function(e){e.preventDefault();var o=t(this),n=o.parent(".rtcl-select-options-wrap"),i=t("table.rtcl-fields-field-value-options tbody",n),a=n.data("type")||"select",l=o.data("name"),s=t("<tr />"),r=Number(new Date),c=t("tr",i).length+1,d=l+"[default]",p="radio";return"checkbox"==a&&(d=l+"[default][]",p="checkbox"),s.append("<td class='num'><span class='js-types-sort-button hndle dashicons dashicons-menu'></span></td>"),s.append("<td><input type='text' name='"+l+"[choices]["+r+"][title]' value='Option title "+c+"' ></td>"),s.append("<td><input type='text' name='"+l+"[choices]["+r+"][value]' value='option-title-"+c+"' ></td>"),s.append("<td><input type='"+p+"' name='"+d+"' value='"+r+"' ></td>"),s.append("<td class='num'><span class='rtcl-delete-option dashicons dashicons-trash'></span></td>"),i.append(s),i.typesFieldOptionsSortable(),!1}),t(document).on("click",".rtcl-cfg-field .rtcl-select-options-wrap .rtcl-delete-option",function(e){(e.preventDefault(),confirm("Are you sure?"))&&t(this).parents("tr").remove();return!1}),t.fn.typesFieldOptionsSortable=function(){t(".rtcl-fields-radio-sortable, .rtcl-fields-select-sortable, .rtcl-fields-checkboxes-sortable",this).sortable({cursor:"ns-resize",axis:"y",handle:".js-types-sort-button",start:function(t,e){e.placeholder.height(e.item.height()-2)}}),t(".rtcl-fields-checkboxes-sortable",this).sortable({start:function(t,e){e.placeholder.height(e.item.height()+13)}})},t.fn.typesMarkExistingField=function(){var e=t(".rtcl-forms-field-slug",this);e.length&&""!=e.val()&&e.attr("data-types-existing-field",e.val())},t("body").typesFieldOptionsSortable(),e.on("keyup",".rtcl-forms-set-legend",function(){var e=t(this).val();e&&(e=(e=(e=(e=e.replace(/</,"&lt;")).replace(/>/,"&gt;")).replace(/'/,"&#39;")).replace(/"/,"&quot;")),t(this).parents(".postbox").find(".rtcl-legend-update").html(e)})}(jQuery),function(t){var e;function o(){t(".ui-dialog").each(function(){t(this).css({maxWidth:"100%",top:t(window).scrollTop()+50+"px",left:(t("body").innerWidth()-t(this).outerWidth())/2+"px"})})}t(document).on("dialogopen",".ui-dialog",function(e,o){t("button.button-primary, button.wpcf-ui-dialog-cancel").blur().addClass("button").removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only")}),t(window).on("resize scroll",function(){clearTimeout(e),e=setTimeout(o,200)})}(jQuery);
