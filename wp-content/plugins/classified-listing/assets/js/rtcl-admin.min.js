!function(t){t.fn.getType=function(){return"INPUT"==this[0].tagName?this[0].type.toLowerCase():this[0].tagName.toLowerCase()};var e='<div class="rtcl-spinner block"><span class="rtcl-icon-spinner animate-spin"></span></div>';function r(e){var r=t("#rtcl-price-row"),i=t("#rtcl-price-wrap"),n=t("#rtcl-price-unit-wrap",r),a=n.length,c={action:"rtcl_get_price_units_ajax",term_id:e||0};t.ajax({url:ajaxurl,data:c,type:"POST",dataType:"json",beforeSend:function(){},success:function(t){t.html?(i.removeClass("col-md-12").addClass("col-md-6"),a&&n.remove(),r.append(t.html)):(i.removeClass("col-md-6").addClass("col-md-12"),n.remove())},error:function(){}})}t(document.body).on("rtcl_add_error_tip",function(e,r,i){var n=r.position();0===r.parent().find(".rtcl_error_tip").length&&(r.after('<div class="rtcl_error_tip '+i+'">'+rtcl[i]+"</div>"),r.parent().find(".rtcl_error_tip").css("left",n.left+r.width()-r.width()/2-t(".rtcl_error_tip").width()/2).css("top",n.top+r.height()).fadeIn("100"))}).on("rtcl_remove_error_tip",function(e,r,i){r.parent().find(".rtcl_error_tip."+i).fadeOut("100",function(){t(this).remove()})}).on("click",function(){t(".rtcl_error_tip").fadeOut("100",function(){t(this).remove()})}).on("blur","#rtcl-price[type=text],#rtcl-pricing-price[type=text]",function(){t(".rtcl_error_tip").fadeOut("100",function(){t(this).remove()})}).on("keyup","#rtcl-price[type=text],#rtcl-pricing-price[type=text]",function(){var e=t(this).attr("id"),r=rtcl.decimal_point,i="i18n_mon_decimal_error";"rtcl-pricing-price"===e&&(r=rtcl.pricing_decimal_point,i="i18n_mon_pricing_decimal_error");var n=new RegExp("[^-0-9%\\"+r+"]+","gi"),a=t(this).val(),c=a.replace(n,"");a!==c?t(document.body).triggerHandler("rtcl_add_error_tip",[t(this),i]):t(document.body).triggerHandler("rtcl_remove_error_tip",[t(this),i])}).on("change","#rtcl-price[type=text],#rtcl-pricing-price[type=text]",function(){var e="rtcl-pricing-price"===t(this).attr("id")?rtcl.pricing_decimal_point:rtcl.decimal_point,r=new RegExp("[^-0-9%\\"+e+"]+","gi"),i=t(this).val(),n=i.replace(r,"");i!==n&&t(this).val(n)}).on("rtcl_price_type_changed",function(e,r){"on_call"==r.value||"free"==r.value||"no_price"==r.value?(t("#rtcl-price").attr("required","false").val(""),t("#rtcl-price-row").hide()):(t("#rtcl-price").attr("required","true"),t("#rtcl-price-row").show())}).on("change","#rtcl-price-type",function(){t(document.body).trigger("rtcl_price_type_changed",[this])});var i=function(e){this._target=e,this.timestampdiv=t(".rtcl-timestamp-div",this._target),this.timestamp=t(".rtcl-timestamp",this._target),this.stamp=this.timestamp.html(),this.timestampwrap=this.timestampdiv.find(".timestamp-wrap"),this.edittimestamp=this.timestampdiv.siblings("a.edit-timestamp"),this.init=function(){var e=this;this.edittimestamp.on("click",function(r){e.timestampdiv.is(":hidden")&&(e.timestampdiv.slideDown("fast",function(){t("input, select",e.timestampwrap).first().focus()}),t(this).hide()),r.preventDefault()}),this.timestampdiv.find(".cancel-timestamp").on("click",function(t){e.edittimestamp.show().focus(),e.timestampdiv.slideUp("fast"),e.timestampdiv.find(".rtcl-mm").val(e.timestampdiv.find(".rtcl-hidden_mm").val()),e.timestampdiv.find(".rtcl-jj").val(e.timestampdiv.find(".rtcl-hidden_jj").val()),e.timestampdiv.find(".rtcl-aa").val(e.timestampdiv.find(".rtcl-hidden_aa").val()),e.timestampdiv.find(".rtcl-hh").val(e.timestampdiv.find(".rtcl-hidden_hh").val()),e.timestampdiv.find(".rtcl-mn").val(e.timestampdiv.find(".rtcl-hidden_mn").val()),e.timestamp.html(e.stamp),t.preventDefault()}),this.timestampdiv.find(".save-timestamp").on("click",function(r){var i=e.timestampdiv.find(".rtcl-aa").val(),n=e.timestampdiv.find(".rtcl-mm").val(),a=e.timestampdiv.find(".rtcl-jj").val(),c=e.timestampdiv.find(".rtcl-hh").val(),l=e.timestampdiv.find(".rtcl-mn").val(),s=new Date(i,n-1,a,c,l);r.preventDefault(),s.getFullYear()==i&&1+s.getMonth()==n&&s.getDate()==a&&s.getMinutes()==l?(e.timestampwrap.removeClass("form-invalid"),e.timestamp.html(rtcl.expiredOn+" <b>"+rtcl.dateFormat.replace("%1$s",t('option[value="'+n+'"]',"#mm").attr("data-text")).replace("%2$s",parseInt(a,10)).replace("%3$s",i).replace("%4$s",("00"+c).slice(-2)).replace("%5$s",("00"+l).slice(-2))+"</b> "),e.edittimestamp.show().focus(),e.timestampdiv.slideUp("fast")):e.timestampwrap.addClass("form-invalid")})},this.init()};t.fn.rtcl_time_stamp=function(){t(this).each(function(){return console.log(t(this)),new i(t(this))})},t(".rtcl-timestamp-wrapper").rtcl_time_stamp(),t(".misc-pub-rtcl-never-expires").on("click","input",function(){t(this).is(":checked")?t(".misc-pub-rtcl-expiration-time").hide():t(".misc-pub-rtcl-expiration-time").show()}),t("#rtcl-ad-type").on("change",function(){var r=t(this),i=r.val(),n=t("#rtcl-price-row");if(n.find(".price-label .rtcl-per-unit").remove(),"to_let"==i){var a=n.find("label").attr("data-per-unit");n.find(".price-label").append('<span class="rtcl-per-unit"> / '+a+"</span>")}if("job"==i||""==i?t("#rtcl-form-price-wrap").slideUp(250):t("#rtcl-form-price-wrap").slideDown(250),i){var c={action:"rtcl_get_one_level_category_select_list_by_type",type:i};t.ajax({url:ajaxurl,data:c,type:"POST",beforeSend:function(){t(e).insertAfter(r),t("#rtcl-custom-fields-list").html(""),t("#rtcl_sub_category").html(""),t("#sub-cat-row").addClass("rtcl-hide")},success:function(e){console.log(e),r.next(".rtcl-spinner").remove(),e.success?t("#rtcl_category").html(e.cats):t("#rtcl_category").html("")},error:function(t){r.next(".rtcl-spinner").remove(),console.log(t.responseText)}})}else t("#rtcl-custom-fields-list").html(""),t("#rtcl_category").html(""),t("#rtcl_sub_category").html(""),t("#sub-cat-row").addClass("rtcl-hide")}),t("#rtcl_category").on("change",function(){var i=t(this),n=t(this).val()||0,a={action:"rtcl_custom_fields_listings",post_id:t("#rtcl-custom-fields-list").data("post_id"),term_id:n,is_admin:rtcl.is_admin};t.ajax({url:ajaxurl,data:a,type:"POST",beforeSend:function(){t(e).insertAfter(i),t("#rtcl-custom-fields-list").html(e)},success:function(e){i.next(".rtcl-spinner").remove(),t("#rtcl-custom-fields-list").html(e.custom_fields),t("#rtcl_sub_category").html(e.child_cats),e.child_cats?t("#sub-cat-row").removeClass("rtcl-hide"):t("#sub-cat-row").addClass("rtcl-hide")},error:function(){i.next(".rtcl-spinner").remove()}}),r(n)}),t("#rtcl_sub_category").on("change",function(){var i=t(this),n=t(this).val()||t("#rtcl_category").val(),a={action:"rtcl_custom_fields_listings",post_id:t("#rtcl-custom-fields-list").data("post_id"),term_id:n};t.ajax({url:ajaxurl,data:a,type:"POST",beforeSend:function(){t(e).insertAfter(i),t("#rtcl-custom-fields-list").html(e)},success:function(e){i.next(".rtcl-spinner").remove(),t("#rtcl-custom-fields-list").html(e.custom_fields)},error:function(){i.next(".rtcl-spinner").remove()}}),r(n)}),t.fn.validate&&(t(".post-type-rtcl_listing #post").validate(),t(".post-type-rtcl_pricing #post").validate()),t("#send-email-to-user").on("click",function(e){e.preventDefault();var r=t('<div style="display:none;height:450px;" id="user-message"><div class="form-group"><textarea class="rtcl-form-control" rows="6"></textarea></div><a class="message-send button button-primary button-large">Send</a></div>').appendTo("body");return r.dialog({close:function(t,e){r.remove()},open:function(e,r){t("#user-message").parent(".ui-dialog").css("zIndex",9999).nextAll(".ui-widget-overlay").css("zIndex",9998)},closeText:!1,modal:!0,maxWidth:850,zIndex:9999,maxHeight:.9*t(window).height(),title:"Message",position:{my:"center top+50",at:"center top",of:window}}),r.on("click","a.message-send",function(e){e.preventDefault();var i=t(this),n=t("#post_ID").val(),a=r.find("textarea").val();if(n&&a){var c={action:"rtcl_send_email_to_user_by_moderator",post_id:n,message:a,__rtcl_wpnonce:rtcl.__rtcl_wpnonce};t.ajax({type:"POST",url:rtcl.ajaxurl,data:c,beforeSend:function(){t(".rtcl-flash-messages").remove(),i.addClass("disabled").attr("disabled","disabled"),t('<span class="rtcl-icon-spinner animate-spin"></span>').insertAfter(i)},success:function(e){i.removeClass("disabled"),t(".rtcl-icon-spinner",r).remove();var n=t("<div class='rtcl-flash-messages'>"+e.message+"</div>");n.insertAfter(i),n.addClass(e.class),e.error?i.removeAttr("disabled"):setTimeout(function(){r.dialog("close")},1e3)},error:function(e,n){t(".rtcl-icon-spinner",r).remove(),r.dialog("close"),i.removeAttr("disabled"),0===e.status?alert("Not connect.\n Verify Network."):404==e.status?alert("Requested page not found. [404]"):500==e.status?alert("Internal Server Error [500]."):"parsererror"===n?alert("Requested JSON parse failed."):"timeout"===n?alert("Time out error."):"abort"===n?alert("Ajax request aborted."):alert("Uncaught Error.\n"+e.responseText)}})}else alert("Please add some message!!");return!1}),!1}),t(function(){t("#rtcl-price-type").trigger("change"),t.fn.select2&&t(".rtcl-select2").select2({dropdownAutoWidth:!0,width:"100%"}),t("#expiry-date").length&&t("#expiry-date").datetimepicker(),t("#rtcl-location").on("change",function(){var r=t(this),i={action:"rtcl_get_sub_location_options",term_id:t(this).val(),blank:!0};t.ajax({url:ajaxurl,data:i,type:"POST",beforeSend:function(){t(e).insertAfter(r)},success:function(e){r.next(".rtcl-spinner").remove(),t("#rtcl-sub-location").html(e.locations),t("#rtcl-sub-sub-location").html("").addClass("rtcl-hide"),e.locations?t("#sub-location-row").removeClass("rtcl-hide"):t("#sub-location-row").addClass("rtcl-hide")},error:function(){r.next(".rtcl-spinner").remove()}})}),t("#rtcl-sub-location").on("change",function(){var r=t(this),i={action:"rtcl_get_sub_location_options",term_id:t(this).val(),blank:!0};t.ajax({url:ajaxurl,data:i,type:"POST",beforeSend:function(){t(e).insertAfter(r)},success:function(e){r.next(".rtcl-spinner").remove(),t("#rtcl-sub-sub-location").html(e.locations),e.locations?t("#sub-sub-location-row").removeClass("rtcl-hide"):t("#sub-sub-location-row").addClass("rtcl-hide")},error:function(){r.next(".rtcl-spinner").remove()}})})})}(jQuery),function(t){var e;function r(){t(".ui-dialog").each(function(){t(this).css({maxWidth:"100%",zIndex:9999,top:t(window).scrollTop()+50+"px",left:(t("body").innerWidth()-t(this).outerWidth())/2+"px"})})}t(document).on("dialogopen",".ui-dialog",function(e,r){t("button.button-primary, button.wpcf-ui-dialog-cancel").blur().addClass("button").removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only")}),t(window).on("resize scroll",function(){clearTimeout(e),e=setTimeout(r,200)}),{init:function(){t("#rtcl-payment-notes").on("click","button.add-note",this.add_order_note).on("click","a.delete_note",this.delete_order_note)},add_order_note:function(){if(t("textarea#rtcl-add-payment-note").val()){var e={action:"rtcl_add_payment_note",post_id:parseInt(t("#post_ID").val(),10)||0,note:t("textarea#rtcl-add-payment-note").val(),note_type:t("select#rtcl-payment-note-type").val(),__rtcl_wpnonce:rtcl.__rtcl_wpnonce};return t.ajax({url:rtcl.ajaxurl,data:e,type:"POST",dataType:"json",beforeSend:function(){t("#rtcl-payment-notes").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},success:function(e){t("ul.rtcl_payment_notes").prepend(e.html),t("#rtcl-payment-notes").unblock(),t("#rtcl-add-payment-note").val("")},error:function(){t("#rtcl-payment-notes").unblock()}}),!1}},delete_order_note:function(){if(window.confirm(rtcl.i18n_delete_note)){var e=t(this).closest("li.note"),r={action:"rtcl_delete_payment_note",note_id:t(e).attr("rel"),__rtcl_wpnonce:rtcl.__rtcl_wpnonce};t.ajax({url:rtcl.ajaxurl,data:r,type:"POST",dataType:"json",beforeSend:function(){t(e).block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},success:function(r){r.success&&t(e).remove()}})}return!1}}.init()}(jQuery);
