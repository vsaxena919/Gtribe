!function(y){"use strict";y(document).ready(function(){var e=!1;y(document).on("input click",".yz-wall-textarea, .ac-input",function(){y(this).next(".yz-load-emojis").attr("data-cursor",y(this).prop("selectionStart"))}),y(document).on("focus",".yz-wall-textarea",function(){0==e&&(y(this).closest("form").find(".yz-lp-prepost").get(0)&&(y("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/yz-url-preview.min.css"}).appendTo("head"),y("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/yz-url-preview.min.js"}).appendTo("head")),e=!0)}),y(document).on("click",".yz-load-emojis",function(){y(this).closest("form");y(this).find("i").attr("class","fas fa-spin fa-spinner"),y(this).addClass("loading"),y("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/emojionearea.min.css"}).appendTo("head"),y("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/emojionearea.min.js"}).appendTo("head")}),y(".yz-wall-post").on("click",function(){var e,l=0,d=y(this),o=y(this).text(),c=d.closest("form#yz-wall-form"),r={};y.each(c.serializeArray(),function(e,t){"_"!==t.name.substr(0,1)&&"whats-new"!==t.name.substr(0,9)&&(r[t.name]?y.isArray(r[t.name])?r[t.name].push(t.value):r[t.name]=new Array(r[t.name],t.value):r[t.name]=t.value)}),c.find("*").each(function(){(y.nodeName(this,"textarea")||y.nodeName(this,"input"))&&y(this).prop("disabled",!0)}),c.find(".yz-wall-textarea").get(0).emojioneArea&&c.find(".yz-wall-textarea").data("emojioneArea").disable(),d.addClass("loading"),d.prop("disabled",!0),c.addClass("submitted"),d.css("min-width",d.css("width")),d.html('<i class="fas fa-spinner fa-spin"></i>');var t="",a=y("#yz-whats-new-post-in").val(),i=y("#whats-new").val(),f=y("#buddypress ul.activity-list li").first(),s=f,n=null;return f.length&&(s.hasClass("load-newest")&&(s=f.next()),n=s.prop("class").match(/date-recorded-([0-9]+)/)),n&&(l=n[1]),0<a&&(t=y("#yz-whats-new-post-object").val()),e=y.extend({action:"yz_post_update",cookie:bp_get_cookies(),_yz_wpnonce_post_update:y("#_yz_wpnonce_post_update").val(),content:i,object:t,item_id:a,since:l,_bp_as_nonce:y("#_bp_as_nonce").val()||""},r),y.post(ajaxurl,e,function(e){if(c.find("*").each(function(){(y.nodeName(this,"textarea")||y.nodeName(this,"input"))&&y(this).prop("disabled",!1)}),c.find(".yz-wall-textarea").get(0).emojioneArea&&c.find(".yz-wall-textarea").data("emojioneArea").enable(),y.yz_isJSON(e)){var t=y.parseJSON(e);y.yz_DialogMsg("error",t.error)}else{if(d.html('<i class="fas fa-check"></i>').hide().fadeIn("slow"),c.find(".yz-delete-attachment").trigger("click"),0===y("ul.activity-list").length&&(y("div.error").slideUp(100).remove(),y("#message").slideUp(100).remove(),y("div.activity").append('<ul id="activity-stream" class="activity-list item-list">')),f.hasClass("load-newest")&&f.remove(),y("#activity-stream").prepend(e),l||y("#activity-stream li:first").addClass("new-update just-posted"),y("body,html").animate({scrollTop:y("#"+y(e).attr("id")).offset().top-65+"px"},1e3),0!==y("#latest-update").length){var a=y("#activity-stream li.new-update .activity-content .activity-inner p").html(),i=y("#activity-stream li.new-update .activity-content .activity-header p a.view").attr("href"),s=y("#activity-stream li.new-update .activity-content .activity-inner p").text(),n="";""!==s&&(n=a+" "),n+='<a href="'+i+'" rel="nofollow">'+BP_DTheme.view+"</a>",y("#latest-update").slideUp(300,function(){y("#latest-update").html(n),y("#latest-update").slideDown(300)})}y("li.new-update").hide().slideDown(300),y("li.new-update").removeClass("new-update"),y("#whats-new").val(""),"activity_slideshow"==r.post_type&&y.youzer_sliders_init(),c.get(0).reset(),c.find(".yz-wall-textarea").get(0).emojioneArea&&c.find(".yz-wall-textarea").get(0).emojioneArea.setText(""),c.find(".yz-tagged-user .yz-tagusers-delete-user, .yz-list-delete-item, .yz-list-close-icon").trigger("click"),c.find("div.yz-activity-privacy").find(".list div").first().trigger("click"),c.find("#yz-whats-new-post-in").next(".nice-select").find(".list div").first().trigger("click"),c.find('.yz-wall-options input:radio[name="post_type"]').first().trigger("change"),c.find(".yz-lp-prepost .lp-button-cancel").trigger("click"),"activity_giphy"==r.post_type&&(c.find(".yz-delete-giphy-item").trigger("click"),c.find(".yz-giphy-submit-search").val("").trigger("click")),newest_activities="",activity_last_recorded=0}setTimeout(function(){d.html(o).fadeIn("slow")},1e3),c.find(".yz-wall-post,.yz-update-post").prop("disabled",!1).removeClass("loading")}),!1}),y(document).on("change",'input:radio[name="post_type"]',function(){var e=y(this).closest("form"),t=y(this).val(),a=y(this).data("uploader");1<y('input:radio[name="post_type"]').length?0==e.find('.yz-wall-custom-form[data-post-type!="'+t+'"]').length?e.find('.yz-wall-custom-form[data-post-type="'+t+'"]').fadeIn():e.find('.yz-wall-custom-form[data-post-type!="'+t+'"]').fadeOut(1,function(){e.find('.yz-wall-custom-form[data-post-type="'+t+'"]').fadeIn()}):e.find('.yz-wall-custom-form[data-post-type="'+t+'"]').fadeIn(),"on"==a?e.find(".yz-wall-actions .yz-wall-upload-btn").fadeIn():e.find(".yz-wall-actions .yz-wall-upload-btn").fadeOut(),"activity_video"==t?e.find(".yz-upload-attachments").attr("accept","video/*"):"activity_audio"==t?e.find(".yz-upload-attachments").attr("accept","audio/*"):"activity_file"==t?e.find(".yz-upload-attachments").removeAttr("accept"):e.find(".yz-upload-attachments").attr("accept","image/*"),e.find(".yz-attachment-item").remove()}),y('input:radio[name="post_type"]').first().trigger("change"),y(document).on("click",".yz-wall-upload-btn",function(e){yz_load_attachments||(y("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/yz-attachments.min.js"}).appendTo("head"),y("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/yz-attachments.min.css"}).appendTo("head"),yz_load_attachments=!0);var t=y(this).closest("form");return!t.find(".yz-file-progress")[0]&&((!t.hasClass("ac-form")||(t.find(".yz-wall-upload-btn").fadeOut(),!t.find(".yz-attachment-item")[0]))&&(t.find(".yz-upload-attachments").click(),void e.preventDefault()))}),y(document).on("click",".yz-tag-users-tool",function(){var i=y(this).closest("form");if(i.find(".yz-feeling-form").fadeOut(),y(this).hasClass("loaded"))return i.find(".yz-tagusers-form").fadeToggle(),void i.find(".yz-tagusers-search-input").focus();var s=y(this),n=s.find("i"),l=n.attr("class");n.attr("class","fas fa-spinner fa-spin"),y.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"yz_tag_users_get_user_friends"},success:function(e){s.addClass("loaded");var t=y("<div></div>").append(e.data);if("youzer-edit-activity-wrapper"==i.parent().attr("id")){var a=[];i.find('input[name="tagged_users[]"]').each(function(){t.find('.yz-list-item[data-user-id="100"] ').fadeOut(),a.push(y(this).val())}),t.find(".yz-list-item").each(function(e,t){-1!==jQuery.inArray(y(this).attr("data-user-id"),a)&&y(this).find(".yz-wall-tag-user").hide()})}i.find(".yz-tagusers-form").fadeIn(200,function(){n.attr("class",l),i.find(".yz-tagusers-search-input").focus(),i.find(".yz-wall-tagusers-list").html(t)})}})}),y(document).on("keyup",".yz-list-search-input",function(){var e=y(this).closest(".yz-wall-list"),t=this.value.toLowerCase().trim();e.find(".yz-wall-list-items .yz-list-item").show().filter(function(){return-1==y(this).find(".yz-item-title, .yz-item-description").text().toLowerCase().trim().indexOf(t)}).hide()}),y(document).on("click",".yz-user-mood-tool",function(){var t=y(this).closest("form");if(t.find(".yz-tagusers-form").fadeOut(),y(this).hasClass("loaded"))return t.find(".yz-feeling-form").fadeToggle(),void t.find(".yz-feeling-search-input").focus();t.find(".yz-feeling-form").attr("data-placeholder",t.find(".yz-feeling-search-input").attr("placeholder"));var a=y(this),i=a.find("i"),s=i.attr("class");i.attr("class","fas fa-spinner fa-spin"),y.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"yz_feeling_activity_get_categories"},success:function(e){a.addClass("loaded"),t.find(".yz-feeling-form").fadeIn(200,function(){i.attr("class",s),t.find(".yz-feeling-search-input").focus(),t.find(".yz-wall-feeling-list").html(e.data)})}})}),y(document).on("click",".yz-feeling-item",function(e){e.preventDefault();var t=y(this),a=t.closest(".yz-wall-feeling");if(y(this).parent().hasClass("yz-list-category-items"))y.yz_select_mood_emojis(a,t.attr("data-emoji"),t.attr("data-category-title"),t.find(".yz-item-img").css("background-image"));else{a.find(".yz-list-items-title").text(t.attr("data-category-title")),a.find('input[name="mood_type"]').val(t.attr("data-category")),a.find(".yz-list-categories").fadeOut(),a.find(".yz-feeling-close-icon").addClass("yz-feeling-go-back"),a.find(".yz-feeling-close-icon i").attr("class","far fa-arrow-alt-circle-left"),a.find('input[name="mood_search"]').val("").attr("placeholder",t.find(".yz-item-description").text()),a.find(".yz-list-search-icon i").attr("class",t.find(".yz-item-icon i").attr("class"));var i=a.find('.yz-list-category-items[data-category="'+y(this).attr("data-category")+'"]');1==i.length?i.fadeIn():a.find(".yz-list-submit-button").fadeIn()}}),y(document).on("click",".yz-feeling-close-icon",function(){var e=y(this),t=e.closest(".yz-wall-feeling");if(t.find(".yz-feeling-submit-button").fadeOut(),t.find(".yz-feeling-search-input").val(""),t.find(".yz-feeling-search-input").attr("placeholder",t.find(".yz-feeling-form").attr("data-placeholder")),t.find(".yz-feeling-search-icon i").attr("class","fas fa-search"),e.hasClass("yz-feeling-go-back"))return e.find("i").attr("class","fas fa-times"),t.find(".yz-list-categories, .yz-list-item").fadeIn(),t.find(".yz-list-category-items").fadeOut(),void e.removeClass("yz-feeling-go-back");e.closest(".yz-feeling-form").fadeOut()}),y(document).on("click",".yz-wall-feeling .yz-list-edit-item",function(){var e=y(this),t=e.closest(".yz-wall-feeling"),a=t.find(".yz-list-selected-items");a.fadeOut(200,function(){t.find(".yz-feeling-search-input").val(a.find(".yz-item-title").text()),e.closest(".yz-selected-item").fadeOut(200,function(){y(this).remove()}),t.find(".yz-feeling-form").fadeIn(),t.removeClass("yz-activity-feeling-selected")})}),y(document).on("click",".yz-wall-feeling .yz-list-delete-item",function(){var e=y(this),t=e.closest(".yz-wall-feeling"),a=t.find(".yz-list-selected-items");a.fadeOut(200,function(){a.find(".yz-item-title").text(""),e.closest(".yz-selected-item").fadeOut(200,function(){y(this).remove()}),t.find(".yz-feeling-close-icon").trigger("click"),t.removeClass("yz-activity-feeling-selected")})}),y(document).on("click",".yz-feeling-submit-button",function(){var e=y(this).closest(".yz-wall-feeling"),t=e.find(".yz-feeling-search-input").val();""!=t.trim()&&y.yz_select_mood_emojis(e,t,t)}),y(document).on("keypress",".yz-feeling-search-input",function(e){if(13==e.keyCode){e.preventDefault();var t=y(this).next(".yz-feeling-submit-button");"none"!=t.css("display")&&t.click()}}),y.yz_select_mood_emojis=function(e,t,a,i){e.hasClass("yz-activity-feeling-selected")&&e.find(".yz-selected-item").remove(),e.addClass("yz-activity-feeling-selected"),e.find(".yz-feeling-form").fadeOut(0,function(){e.find(".yz-feeling-selected-items").fadeIn()});var s=null==i?"":"<div class='yz-item-img' style='background-image: "+i+";'></div>",n=null==i?" yz-selected-item-no-image":"";e.find(".yz-list-selected-items").append('<div class="yz-selected-item yz-feeling-selected-item'+n+'">'+s+'<div class="yz-item-title">'+a+'</div><i class="fas fa-pencil-alt yz-selected-item-tool yz-list-edit-item"></i><i class="fas fa-trash-alt yz-selected-item-tool yz-list-delete-item"></i><input type="hidden" name="mood_value" value="'+t+'"></div>').fadeIn(),e.find(".yz-feeling-search-input").val("")},y(document).on("click",".yz-wall-tag-user",function(){var a=y(this);if(!a.hasClass("yz-selected")){a.addClass("yz-selected");var i=a.closest(".yz-list-item");y(this).fadeOut(200,function(){var e="<div class=\"yz-selected-item yz-tagged-user\"><div class='yz-item-img' style='background-image: "+i.find(".yz-item-img").css("background-image")+';\'></div><div class="yz-item-title">'+i.find(".yz-item-title").text()+'</div><i class="fas fa-trash-alt yz-selected-item-tool yz-list-delete-item yz-tagusers-delete-user" data-user-id="'+i.attr("data-user-id")+'"></i><input type="hidden" name="tagged_users[]" value="'+i.attr("data-user-id")+'"></div>';i.closest(".yz-wall-tagusers").find(".yz-tagged-users").append(e);a.closest(".yz-wall-tagusers").find(".yz-tagged-user").length;var t=a.closest(".yz-wall-tagusers");1==t.find(".yz-tagged-user").length&&t.find(".yz-tagged-users").fadeIn()})}}),y(document).on("click",".yz-list-close-icon.yz-tagusers-close-icon",function(){y(this).closest(".yz-tagusers-form").fadeOut()}),y(document).on("click",".yz-tagusers-delete-user",function(){y(this).parent();var e=y(this).closest(".yz-wall-tagusers"),t=y(this).closest(".yz-tagged-users");e.find(".yz-list-item[data-user-id="+y(this).attr("data-user-id")+"] .yz-wall-tag-user").removeClass("yz-selected").fadeIn(),y(this).parent().fadeOut(200,function(){y(this).remove(),0==t.find(".yz-tagged-user").length&&t.fadeOut()})}),y(document).on("change","#yz-whats-new-post-in",function(e){0!=y(this).val()?y(this).closest(".yz-wall-actions").find("div.yz-activity-privacy").fadeOut():y(this).closest(".yz-wall-actions").find("div.yz-activity-privacy").fadeIn()}),y(document).on("click",".yz-send-comment",function(e){if(e.preventDefault(),!y(this).hasClass("loading")){var i,s,t,a,n,l,d,o,c,r,f=y(this);return f.addClass("loading"),r=f.find("i").attr("class"),f.find("i").attr("class","fas fa-spinner fa-spin"),t=(i=f.parents("form")).parent(),n=i.attr("id").split("-"),a=t.hasClass("activity-comments")?n[2]:t.attr("id").split("-")[1],s=y("#"+i.attr("id")+" textarea"),y("#"+i.attr("id")+" div.error").hide(),f.addClass("loading").prop("disabled",!0),s.addClass("loading").prop("disabled",!0),l={action:"new_activity_comment",cookie:bp_get_cookies(),_wpnonce_new_activity_comment:y("#_wpnonce_new_activity_comment").val(),comment_id:a,form_id:n[2],content:s.val()},(d=y("#_bp_as_nonce_"+a).val())&&(l["_bp_as_nonce_"+a]=d),y.post(ajaxurl,l,function(t){if(f.removeClass("loading"),s.removeClass("loading"),f.find("i").attr("class",r),t[0]+t[1]==="-1")i.append(y(t.substr(2,t.length)).hide().fadeIn(200));else{var a=i.parent();i.fadeOut(200,function(){0===a.children("ul").length&&(a.hasClass("activity-comments")?a.prepend("<ul></ul>"):a.append("<ul></ul>"));var e=y.trim(t);a.children("ul").append(y(e).hide().fadeIn(200)),i.children("textarea").val(""),a.parent().addClass("has-comments")}),y("#"+i.attr("id")+" textarea").val(""),o=Number(y("#activity-"+n[2]+" a.acomment-reply span").html())+1,y("#activity-"+n[2]+" a.acomment-reply span").html(o),(c=a.parents(".activity-comments").find(".show-all a"))&&c.html(BP_DTheme.show_x_comments.replace("%d",o))}y(f).prop("disabled",!1),y(s).prop("disabled",!1)}),!1}}),y(document).on("keypress",".ac-form textarea",function(e){13!=e.which||e.shiftKey||(e.preventDefault(),y(this).closest("form").find(".yz-send-comment").click())}),y.yz_isPostType=function(e,t){return t==e.find('input:radio[name="post_type"]:checked').val()}})}(jQuery);